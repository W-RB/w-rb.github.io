<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
<link rel="stylesheet" href="/css/prism.css">
 
    
<script src="/js/prism.js"></script>


    <!--Description-->
    
        <meta name="description" content="æŒç»­æ›´æ–°ã€‚">
    

    <!--Author-->
    
        <meta name="author" content="å¤ä½‘">
    

    <!-- Title -->
    
    <title>åŠ¨æ€è§„åˆ’é¢˜ç›®éšè§£ | å¤èŠ±ç››å¼€ï¼Œä½‘æµ…æµ…è€Œå½’</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.jsdelivr.net/npm/bootstrap@3.3.6/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">



    <!-- Custom Fonts -->
    <link href="//cdn.jsdelivr.net/npm/font-awesome@4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- jQuery -->
    <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="//cdn.jsdelivr.net/npm/bootstrap@3.3.6/dist/js/bootstrap.min.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="å¤èŠ±ç››å¼€ï¼Œä½‘æµ…æµ…è€Œå½’" type="application/atom+xml">
</head>



<link rel="stylesheet" href="/css/prism.css">
 

<script src="/js/prism.js"></script>


<body>

    <!-- Content -->
    <section class="article-container">
    <!-- Back Home -->
    <a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

        <!-- Page Header -->
        <header class="intro-header">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <div class="post-heading">
                            <h1>
                                åŠ¨æ€è§„åˆ’é¢˜ç›®éšè§£
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Post Content -->
        <article>
            <div class="container">
                <div class="row">
                    <!-- Post Main Content -->
                    <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <p>æŒç»­æ›´æ–°ã€‚</p>
<span id="more"></span>
<h1><span id="cf258d-littleelephant-and-broken-sorting">CF258D Little
Elephant and Broken Sorting</span></h1>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/258/problem/D">Link</a><span class="math inline">\((^*2600)\)</span></p>
<blockquote>
<p>ç»™å®šæ’åˆ— <span class="math inline">\(p\)</span>ï¼Œæœ‰ <span class="math inline">\(m\)</span> æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œç»™å®š <span class="math inline">\(x,y\)</span>ï¼Œç­‰æ¦‚ç‡é€‰æ‹©æ˜¯å¦äº¤æ¢ã€‚æ±‚ <span class="math inline">\(\sum\limits_{i=1}^{n}\sum\limits_{j=i}^{n}P(p_i&gt;p_j)\)</span>ã€‚</p>
<p><span class="math inline">\(n,m\leq 10^3\)</span>ã€‚</p>
</blockquote>
<p>è€ƒè™‘ç›´æ¥è®¾ <span class="math inline">\(f_{l,r}\)</span> è¡¨ç¤º <span class="math inline">\(p_l&gt;p_r\)</span>
çš„æ¦‚ç‡ã€‚åˆå§‹åŒ–å¾ˆå¥½åˆå§‹åŒ–ï¼Œæˆ‘ä»¬è€ƒè™‘ç›´æ¥å¯¹æ“ä½œè¿›è¡Œè½¬ç§»ã€‚</p>
<p>å‡å¦‚æˆ‘ä»¬è¦äº¤æ¢ <span class="math inline">\(p_l\)</span> å’Œ <span class="math inline">\(p_r\)</span>ï¼Œé‚£ä¹ˆæ­¤æ—¶å…¶æœ¬èº« <span class="math inline">\(f_{l,r}=f_{r,l}=0.5\)</span>ã€‚å¯¹äº <span class="math inline">\(\forall x\neq
l,r\)</span>ï¼Œè€ƒè™‘ä¸äº¤æ¢å’Œäº¤æ¢ä¹‹åçš„æ”¹å˜ã€‚</p>
<p>å¯ä»¥åˆ†ä»¥ä¸‹æƒ…å†µè®¨è®ºï¼š</p>
<ol type="1">
<li><span class="math inline">\(f_{x,l}=\dfrac{f_{x,l}+f_{x,r}}{2}\)</span>ï¼›</li>
<li><span class="math inline">\(f_{r,x}=\dfrac{f_{r,x}+f_{l,x}}{2}\)</span>ï¼›</li>
<li><span class="math inline">\(f_{l,x}=\dfrac{f_{l,x}+f_{r,x}}{2}\)</span>ï¼›</li>
<li><span class="math inline">\(f_{x,r}=\dfrac{f_{x,r}+f_{x,l}}{2}\)</span>ã€‚</li>
</ol>
<p>å®¹æ˜“å‘ç° <span class="math inline">\(1\)</span> å’Œ <span class="math inline">\(4\)</span>ã€<span class="math inline">\(2\)</span>
å’Œ <span class="math inline">\(3\)</span>
çš„è½¬ç§»æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥ä¸€èµ·å¤„ç†ã€‚æœ€åæ‰«ä¸€éå³å¯ï¼Œ<span class="math inline">\(O(n^2)\)</span>ã€‚</p>
<details>
<summary>
Code(Tap)
</summary>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">read</span>(l, r);</span><br><span class="line">    f[l][r] = f[r][l] = <span class="number">0.5</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; x++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x == l || x == r) <span class="keyword">continue</span>;</span><br><span class="line">        f[x][l] = f[x][r] = ((f[x][l] + f[x][r]) / <span class="number">2.00</span>);</span><br><span class="line">        f[r][x] = f[l][x] = ((f[r][x] + f[l][x]) / <span class="number">2.00</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
<h1><span id="cf1185g2-playlist-forpolycarp">CF1185G2 Playlist for
Polycarp</span></h1>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1185/problem/G2">Link</a><span class="math inline">\((^*2600)\)</span></p>
<blockquote>
<p>ç»™å®š <span class="math inline">\(n\)</span> é¦–æ­Œï¼Œæ¯é¦–æ­Œæœ‰æ—¶é—´ <span class="math inline">\(t_i\)</span> ä¸æµæ´¾ <span class="math inline">\(g_i\)</span>ã€‚éœ€è¦ä»ä¸­æ’åˆ—è‹¥å¹²é¦–æ­Œï¼Œä½¿å¾—æ—¶é—´æ°å¥½ä¸º
<span class="math inline">\(T\)</span>ï¼Œä¸”ç›¸é‚»æµæ´¾ä¸åŒã€‚</p>
<p><span class="math inline">\(1\leq n\leq 50,1\leq T\leq 2500,1\leq
t_i\leq 50,1\leq g_i\leq 3\)</span>ã€‚</p>
</blockquote>
<p>ä¸å¦¨è®¾ <span class="math inline">\(f_{i,j,k,1/2/3}\)</span>
è¡¨ç¤ºä¸‰ç§æµæ´¾åˆ†åˆ«é€‰äº† <span class="math inline">\(i,j,k\)</span>
é¦–ï¼Œæœ€åä¸€é¦–ä¸º <span class="math inline">\(1/2/3\)</span>
çš„æ–¹æ¡ˆæ•°ã€‚è¿™ä¸ªæ˜¾ç„¶æ˜¯å¾ˆå¥½è½¬ç§»çš„ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n^3)\)</span>ã€‚ç”±äºæˆ‘ä»¬è¦æ±‚çš„æ˜¯æ’åˆ—ï¼Œå› æ­¤è¿˜è¦ä¹˜ä¸€ä¸ª
<span class="math inline">\(i!j!k!\)</span>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬åœ¨è€ƒè™‘ç›¸é‚»æµæ´¾ä¸åŒï¼Œæ—¶é—´æ°å¥½ä¸º <span class="math inline">\(T\)</span>
çš„æ–¹ç¨‹ã€‚è¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼äºèƒŒåŒ…ï¼Œä½†æ˜¯ç›´æ¥èƒŒåŒ…æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="math inline">\(O(n^3T)\)</span> çš„ï¼Œä¸èƒ½æ¥å—ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒå·§å¦™çš„æ–¹æ³•ï¼šå°†èƒŒåŒ…æ‹†åˆ†æˆä¸¤ä¸ªèƒŒåŒ…ä¹‹åå†åˆ†åˆ«æ±‚è§£ã€‚å³æˆ‘ä»¬è®°
<span class="math inline">\(g_{i,t}\)</span> ä¸ºé€‰æ‹© <span class="math inline">\(1\)</span> çš„èƒŒåŒ…ï¼Œ<span class="math inline">\(h_{j,k,t}\)</span> ä¸ºé€‰æ‹© <span class="math inline">\(2,3\)</span> çš„èƒŒåŒ…ã€‚è¿™æ ·æ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸º <span class="math inline">\(O(nT),O(n^2T)\)</span>ã€‚æœ€åæˆ‘ä»¬åªéœ€è¦æšä¸¾ <span class="math inline">\(g\)</span> çš„ <span class="math inline">\(t\)</span>ï¼Œ<span class="math inline">\(h\)</span>
çš„ <span class="math inline">\(t\)</span> å¯ä»¥ç”± <span class="math inline">\(T-t\)</span> å¾—å‡ºã€‚</p>
<p>æœ€åæˆ‘ä»¬å°†ç­”æ¡ˆä¹˜åœ¨ä¸€èµ·å³å¯ã€‚</p>
<details>
<summary>
Code(Tap)
</summary>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>] = f[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">2</span>] = f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n1; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n2; j++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt;= n3; k++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> v = <span class="number">1</span>; v &lt;= <span class="number">3</span>; v++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(f[i][j][k][v] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(v != <span class="number">1</span>) f[i + <span class="number">1</span>][j][k][<span class="number">1</span>] += f[i][j][k][v], f[i + <span class="number">1</span>][j][k][<span class="number">1</span>] %= mod;</span><br><span class="line">                <span class="keyword">if</span>(v != <span class="number">2</span>) f[i][j + <span class="number">1</span>][k][<span class="number">2</span>] += f[i][j][k][v], f[i][j + <span class="number">1</span>][k][<span class="number">2</span>] %= mod;</span><br><span class="line">                <span class="keyword">if</span>(v != <span class="number">3</span>) f[i][j][k + <span class="number">1</span>][<span class="number">3</span>] += f[i][j][k][v], f[i][j][k + <span class="number">1</span>][<span class="number">3</span>] %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">g[<span class="number">0</span>][<span class="number">0</span>] = h[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = i; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = T - a[<span class="number">1</span>][i]; k &gt;= <span class="number">0</span>; k--)</span><br><span class="line">            g[j + <span class="number">1</span>][k + a[<span class="number">1</span>][i]] += g[j][k], g[j + <span class="number">1</span>][k + a[<span class="number">1</span>][i]] %= mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n2; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = i; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = T - a[<span class="number">2</span>][i]; k &gt;= <span class="number">0</span>; k--)</span><br><span class="line">            h[j + <span class="number">1</span>][<span class="number">0</span>][k + a[<span class="number">2</span>][i]] += h[j][<span class="number">0</span>][k], h[j + <span class="number">1</span>][<span class="number">0</span>][k + a[<span class="number">2</span>][i]] %= mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n3; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = n2; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = i; k &gt;= <span class="number">0</span>; k--)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> v = T - a[<span class="number">3</span>][i]; v &gt;= <span class="number">0</span>; v--)</span><br><span class="line">                h[j][k + <span class="number">1</span>][v + a[<span class="number">3</span>][i]] += h[j][k][v], h[j][k + <span class="number">1</span>][v + a[<span class="number">3</span>][i]] %= mod;</span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n1; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n2; j++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt;= n3; k++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> t = <span class="number">0</span>; t &lt;= T; t++)</span><br><span class="line">                <span class="keyword">if</span>(g[i][T - t])</span><br><span class="line">                    ans += ((f[i][j][k][<span class="number">1</span>] + f[i][j][k][<span class="number">2</span>]) % mod + f[i][j][k][<span class="number">3</span>]) % mod * fct[i] % mod * fct[j] % mod * fct[k] % mod * h[j][k][t] % mod * g[i][T - t] % mod, ans %= mod;</span><br></pre></td></tr></table></figure>
</details>
<h1><span id="cf1699e-three-days-grace">CF1699E Three Days Grace</span></h1>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1699/problem/E">link</a><span class="math inline">\((^*2600)\)</span></p>
<blockquote>
<p>ç»™å®š <span class="math inline">\(n\)</span> ä¸ªå…ƒç´ çš„å¯é‡é›† <span class="math inline">\(S\)</span>ï¼Œå€¼åŸŸä¸º <span class="math inline">\([1,m]\)</span>ï¼Œä½ å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼šé€‰æ‹© <span class="math inline">\(A_i\in S\)</span>ï¼Œå°†å…¶æ‹†åˆ†æˆ <span class="math inline">\(p\cdot q=A_i\)</span>ï¼Œåˆ é™¤ <span class="math inline">\(A_i\)</span> å¹¶åŠ å…¥ <span class="math inline">\(p,q\)</span>ã€‚éœ€è¦æœ€å°åŒ–æå·®ã€‚</p>
<p><span class="math inline">\(1\leq n\leq 10^6, 1\leq m\leq 5\cdot
10^6\)</span>ã€‚</p>
</blockquote>
<p>æƒ³è±¡ä¸€ä¸ªç«–ç›´çš„æ•°è½´ï¼Œè€ƒè™‘å°†ä¸€ä¸ªç‚¹æ‹†åˆ†çš„è¿‡ç¨‹å®é™…ç›¸å½“äºå°†æ¯”è¾ƒé«˜çš„ç‚¹å˜æ¢åˆ°æ¯”è¾ƒä½çš„ä½ç½®ã€‚</p>
<p>è¿™ç»™æˆ‘ä»¬ä¸€ä¸ªå¯ç¤ºï¼šç­”æ¡ˆä¸€å®šåœ¨ä¸€ä¸ªåŒºé—´ <span class="math inline">\([l,r]\)</span>
å†…ï¼Œè¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥æ‰¾å‡ºç±»ä¼¼äºåŒæŒ‡é’ˆçš„æ–¹æ³•ï¼šå›ºå®š <span class="math inline">\(l\)</span>ï¼Œå¹¶ä»å¤§åˆ°å°ç»´æŠ¤ <span class="math inline">\(r\)</span>ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬ä¸å¦¨è®¾ <span class="math inline">\(f_{l,i}\)</span>
è¡¨ç¤ºåŒºé—´ä¸‹ç•Œåœ¨ <span class="math inline">\(l\)</span>ï¼Œå½“å‰æšä¸¾åˆ°ç‚¹
<span class="math inline">\(i\)</span>ï¼Œæ­¤æ—¶çš„æœ€å°æœ€å¤§å€¼ã€‚</p>
<p>è€ƒè™‘è½¬ç§»åˆ° <span class="math inline">\(j\)</span>ï¼Œè‹¥ <span class="math inline">\(j\)</span> ä¸èƒ½è¢«æ‹†åˆ†å‡ºæ¥ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_{l,i}=f_{l+1,i}\)</span>ï¼›å¦‚æœ <span class="math inline">\(j\)</span>
å¯ä»¥è¢«æ‹†åˆ†å‡ºæ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™ä¸ªæ‹†å‡ºå»ï¼Œ<span class="math inline">\(f_{l,i}=\min\{f_{l,\frac{j}{i}}\,f_{l,i}\}\)</span>ã€‚ç”±äºä¸ä¸€å®šåªæ‹†å‡ºæ¥ä¸€ä¸ª
<span class="math inline">\(i\)</span>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›å¤šé‡èƒŒåŒ…çš„æ€æƒ³ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·æ˜¯ä¸èƒ½æ¥å—çš„ã€‚è€ƒè™‘æ€ä¹ˆä¼˜åŒ–ï¼šé¦–å…ˆå¯ä»¥å‹æ‰ç¬¬ä¸€ç»´ï¼Œç„¶åç¬¬äºŒç»´ä»
<span class="math inline">\(i\times i\)</span> å¼€å§‹æ¯æ¬¡ <span class="math inline">\(+i\)</span>ï¼Œæ˜¯è°ƒå’Œçº§æ•°çº§åˆ«çš„ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è€ƒè™‘åœ¨ <span class="math inline">\(i\)</span>
ä¸å˜çš„æƒ…å†µä¸‹ï¼Œéšç€ <span class="math inline">\(l\)</span> ä¸‹é™ï¼Œ<span class="math inline">\(f\)</span> æ˜¯å•è°ƒé€’å‡çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹ <span class="math inline">\(f\)</span>
æ•°ç»„å¼€æ¡¶ï¼Œç”¨æŒ‡é’ˆå‘ä¸‹æ‰«åˆ°ç¬¬ä¸€ä¸ªå­˜åœ¨å€¼çš„ä½ç½®ã€‚</p>
<p>è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="math inline">\(O(m\log m)\)</span>
çš„ã€‚</p>
<details>
<summary>
Code(Tap)
</summary>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span>(n, m);</span><br><span class="line"><span class="built_in">memset</span>(a, <span class="number">0</span>, (m + <span class="number">1</span>) * <span class="number">8</span>);</span><br><span class="line"><span class="built_in">memset</span>(t, <span class="number">0</span>, (m + <span class="number">1</span>) * <span class="number">8</span>);</span><br><span class="line"><span class="type">int</span> lim = <span class="number">1e9</span> + <span class="number">7</span>, ans = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">read</span>();</span><br><span class="line">    lim = <span class="built_in">min</span>(lim, x);</span><br><span class="line">    a[x] = t[x] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) f[i] = i;</span><br><span class="line"><span class="type">int</span> pt = m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = m; i; i--)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(i * i &lt;= m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i * i; j &lt;= m; j += i)</span><br><span class="line">        &#123;</span><br><span class="line">            t[f[j]] -= a[j];</span><br><span class="line">            f[j] = <span class="built_in">min</span>(f[j], f[j / i]);</span><br><span class="line">            t[f[j]] += a[j]; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!t[pt]) pt--;</span><br><span class="line">    <span class="keyword">if</span>(i &lt;= lim) ans = <span class="built_in">min</span>(ans, pt - i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure>
</details>


                            <!-- Meta -->
                            <div class="post-meta">
                                <hr>
                                <br>
                                <div class="post-tags">
                                    
                                                

<a href="/categories/é¢˜è§£/">é¢˜è§£</a>

                                                    
                                </div>
                                <div class="post-date">
                                    
                                        2023-09-05
                                    
                                </div>
                            </div>
                    </div>

                    <!-- Comments -->
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <!-- Disqus Comments -->


                    </div>
                </div>
            </div>
        </article>
</section>

<!-- Image viewer-->

    <!-- Custom picture view-->
    <link href="/css/viewer.min.css" rel="stylesheet" />
    <script
      src="/js/viewer.min.js"
      type="text/javascript"
      charset="utf-8"
    ></script>
    
    <script type="text/javascript">
      // set image viewer
      Viewer.setDefaults({
        zoomRatio: [0.5],
        navbar: false,
        toolbar: false,
        button: false,
        title: [2, (image, imageData) => `${image.alt}`],
        show: function() {
          this.viewer.zoomTo(0.5);
        }
      });
      var imageList = document.getElementsByTagName("img");
      Array.prototype.forEach.call(imageList, element => {
        var viewer = new Viewer(element);
      });
    </script>

    
    <!-- Scripts -->
    <script type="text/javascript">
    console.log("Â© zchen9 ğŸ™‹ 2015-" + new Date().getFullYear());
</script>
  
    <!-- Google Analytics -->
    

    <!-- Service Worker -->
    <!-- if using service worker -->

    

    <footer id="footer">
    <div class="outer">
      <div id="footer-info" class="inner">
        &copy; 2023 å¤ä½‘<br>
        <a href="/">ä¸»é¡µ</a> | <a href="/about/">å…³äº</a> | <a href="/links/">å‹é“¾</a>
      </div>
    </div>
</footer>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</body>

</html>